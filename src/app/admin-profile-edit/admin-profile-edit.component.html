<div class="content-page">
   <div class="container-fluid">
      <div class="row">
         <div class="col-lg-12">
            <div class="card">
               <div class="card-body p-0">
                  <div class="iq-edit-list usr-edit">
                    <ul class="iq-edit-profile d-flex nav nav-pills">
                       <li class="col-md-6 p-0">
                          <a class="nav-link active" data-toggle="pill" href="#personal-information">
                          Personal Information
                          </a>
                       </li>
                       <li class="col-md-6 p-0">
                          <a class="nav-link" data-toggle="pill" href="#chang-pwd">
                          Change Password
                          </a>
                       </li>
                    </ul>
                  </div>
               </div>
            </div>
         </div>
         <div class="col-lg-12">
            <div class="iq-edit-list-data">
               <div class="tab-content">
                  <div class="tab-pane fade active show" id="personal-information" role="tabpanel">
                     <div class="card">
                        <div class="card-header d-flex justify-content-between">
                           <div class="iq-header-title">
                              <h4 class="card-title">Personal Information</h4>
                           </div>
                        </div>
                        <div class="card-body">
                          <form [formGroup]="profileForm" (ngSubmit)="updateUserProfile()">
                            <div *ngIf="successMessage" class="alert alert-success" role="alert">
                              {{ successMessage }}
                            </div>
                            <div *ngIf="errorMessage" class="alert alert-danger" role="alert">
                              {{ errorMessage }}
                            </div>
                            <div class="form-group row align-items-center">
                              <div class="col-md-12">
                                 <div class="profile-img-edit">
                                    <div class="crm-profile-img-edit">
                                     <img class="crm-profile-pic rounded avatar-100" [src]="selectedImage || '../assets/images/user/11.png'" alt="profile-pic">
                                     <div class="crm-p-image bg-primary">
                                       <i class="las la-pen upload-button">
                                         <input (change)="selectImage($event)" class="custom-file-input" type="file" formControlName="image">
                                       </i>
                                     </div>
                                    </div>                                          
                                  </div>
                               </div>
                             </div>

                             <div class="row align-items-center">
                               <div class="form-group col-sm-6">
                                 <label for="fname">First Name:</label>
                                 <input type="text" class="form-control" id="fname" formControlName="firstName">
                                 <div *ngIf="submittedProfile && fProfile['firstName']['errors']" class="invalid-feedback d-block">
                                   <div *ngIf="fProfile['firstName']['errors']['required']">First Name is required</div>
                                   <div *ngIf="fProfile['firstName']['errors']['minlength']">First Name must be at least 2 characters</div>
                                   <div *ngIf="fProfile['firstName']['errors']['maxlength']">First Name must not exceed 30 characters</div>
                                 </div>
                               </div>
                               <div class="form-group col-sm-6">
                                 <label for="lname">Last Name:</label>
                                 <input type="text" class="form-control" id="lname" formControlName="lastName">
                                 <div *ngIf="submittedProfile && fProfile['lastName']['errors']" class="invalid-feedback d-block">
                                   <div *ngIf="fProfile['lastName']['errors']['required']">Last Name is required</div>
                                   <div *ngIf="fProfile['lastName']['errors']['minlength']">Last Name must be at least 2 characters</div>
                                   <div *ngIf="fProfile['lastName']['errors']['maxlength']">Last Name must not exceed 30 characters</div>
                                 </div>
                               </div>
                               <div class="form-group col-sm-6">
                                 <label for="uname">Email:</label>
                                 <input type="email" class="form-control" id="uname" formControlName="email">
                                 <div *ngIf="submittedProfile && fProfile['email']['errors']" class="invalid-feedback d-block">
                                   <div *ngIf="fProfile['email']['errors']['required']">Email is required</div>
                                   <div *ngIf="fProfile['email']['errors']['email']">Email is invalid</div>
                                 </div>
                               </div>
                               <div class="form-group col-sm-6">
                                 <label for="phone">Phone:</label>
                                 <input type="tel" class="form-control" id="phone" formControlName="phone">
                                 <div *ngIf="submittedProfile && fProfile['phone']['errors']" class="invalid-feedback d-block">
                                   <div *ngIf="fProfile['phone']['errors']['required']">Phone is required</div>
                                   <div *ngIf="fProfile['phone']['errors']['pattern']">Phone must be a valid number (8 digits)</div>
                                 </div>
                               </div>
                             </div>
                             <button type="submit" class="btn btn-primary mr-2">Submit</button>
                             <button type="button" class="btn iq-bg-danger" (click)="resetForm()">Cancel</button>
                           </form>
                        </div>
                     </div>
                  </div>
                  <div class="tab-pane fade" id="chang-pwd" role="tabpanel">
                     <div class="card">
                         <div class="card-header d-flex justify-content-between">
                             <div class="iq-header-title">
                                 <h4 class="card-title">Change Password</h4>
                             </div>
                         </div>
                         <div class="card-body">
                             <form [formGroup]="passwordForm" (ngSubmit)="changePassword()">
                                 <div *ngIf="successMessage" class="alert alert-success" role="alert">
                                   {{ successMessage }}
                                 </div>
                                 <div *ngIf="errorMessage" class="alert alert-danger" role="alert">
                                   {{ errorMessage }}
                                 </div>
                                 <div class="form-group">
                                     <label for="cpass">Current Password:</label>
                                     <a href="javascripe:void();" class="float-right" (click)="forgotPassword()">Forgot Password</a>
                                     <input type="password" class="form-control" id="cpass" formControlName="currentPassword">
                                     <div *ngIf="submittedPassword && fPassword['currentPassword']['errors']" class="invalid-feedback d-block">
                                       <div *ngIf="fPassword['currentPassword']['errors']['required']">Current Password is required</div>
                                     </div>
                                 </div>
                                 <div class="form-group">
                                     <label for="npass">New Password:</label>
                                     <input type="password" class="form-control" id="npass" formControlName="newPassword">
                                     <div *ngIf="submittedPassword && fPassword['newPassword']['errors']" class="invalid-feedback d-block">
                                       <div *ngIf="fPassword['newPassword']['errors']['required']">New Password is required</div>
                                       <div *ngIf="fPassword['newPassword']['errors']['minlength']">New Password must be at least 6 characters</div>
                                       <div *ngIf="fPassword['newPassword']['errors']['maxlength']">New Password must not exceed 40 characters</div>
                                     </div>
                                 </div>
                                 <div class="form-group">
                                     <label for="vpass">Verify Password:</label>
                                     <input type="password" class="form-control" id="vpass" formControlName="verifyPassword">
                                     <div *ngIf="submittedPassword && fPassword['verifyPassword']['errors']" class="invalid-feedback d-block">
                                       <div *ngIf="fPassword['verifyPassword']['errors']['required']">Verify Password is required</div>
                                       <div *ngIf="passwordForm.errors?.['mismatch']">Passwords do not match</div>
                                     </div>
                                 </div>
                                 <button type="submit" class="btn btn-primary mr-2">Submit</button>
                                 <button type="button" class="btn iq-bg-danger" (click)="resetPasswordForm()">Cancel</button>
                             </form>
                         </div>
                     </div>
                 </div>
                </div>
             </div>
          </div>
       </div>
    </div>
 </div>
